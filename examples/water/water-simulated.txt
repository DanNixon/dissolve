# Minimal Example: Water

# Define Water Molecule
Species 'Water'
  # Atoms
  Atom    1    O     0.015   -0.009   -0.373   'OW'
  Atom    2    H     0.757    0.013    0.217   'HW'
  Atom    3    H    -0.771   -0.003    0.157   'HW'

  # Intramolecular Terms
  Bond   Harmonic  1    2    3000.000   0.995
  Bond   Harmonic  1    3    3000.000   0.995
  Angle  Harmonic  2    1    3   400.0   109.500

  # Isotopologues
  Isotopologue  'Natural'  OW=0  HW=0
  Isotopologue  'Deuteriated'  OW=0  HW=2
EndSpecies

# Define Configuration
Configuration  'Bulk'
  Density  9.99999642E-02 atoms/A3
  Multiplier  1000
  SpeciesInfo  'Water'  1.0

  UseOutputAsInput

  Module MolShake
  EndModule
  Module IntraShake
  EndModule
EndConfiguration

# Structure Factors
Module Partials 'H2O'
  StructureFactor  on
  Weights  Neutron
  QBroadening  QDependentGaussian  0.02
  Configuration  'Bulk'
  Isotopologue  'Bulk'  'Water'  'Natural'  1.0
  Averaging  10
  AveragingScheme  Simple
EndModule

Module Partials 'HDO'
  StructureFactor  on
  Weights  Neutron
  QBroadening  QDependentGaussian  0.02
  Configuration  'Bulk'
  Isotopologue  'Bulk'  'Water'  'Deuteriated'  0.5
  Isotopologue  'Bulk'  'Water'  'Natural'  0.5
EndModule

Module Partials 'D2O'
  StructureFactor  on
  Weights  Neutron
  QBroadening  QDependentGaussian  0.02
  Configuration  'Bulk'
  Isotopologue  'Bulk'  'Water'  'Deuteriated'  1.0
EndModule

# Data Targets
Data  'Simulated-D2O'
  File  'simulated/D2O-weighted-total.sq'
  AssociatedTo  'D2O'
EndData

Data  'Simulated-H2O'
  File  'simulated/H2O-weighted-total.sq'
  AssociatedTo  'H2O'
EndData

Data  'Simulated-HDO'
  File  'simulated/HDO-weighted-total.sq'
  AssociatedTo  'HDO'
EndData


# Fitting

Module Energy
  Configuration  'Bulk'
EndModule

Module  Test
  # Define targets
  Data  'Simulated-H2O'
  Data  'Simulated-D2O'
  Data  'Simulated-HDO'
  Frequency  5
EndModule

# Pair Potentials
PairPotentials
  Range  15.000000
  Delta  0.050000
  TruncationWidth  2.000000
  Parameters  'OW'  -0.60      0.2503    2.8
  Parameters  'HW'  0.30       0.0       0.0
  GenerateAll  'LJ'
EndPairPotentials

Simulation
  MaxIterations  2000
EndSimulation
